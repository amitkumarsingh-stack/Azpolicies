Compliance & Security Controls ‚Äì Bicep Deployment for Private Azure Monitor & AKS
1. Objective

This deployment enforces a private, secure, and compliant telemetry pipeline for AKS Prometheus metrics by ensuring:

No public exposure of monitoring endpoints

Controlled network access via Private Link

Centralized data ingestion and governance

Alignment with Zero Trust and Azure Well-Architected security pillars

‚ö†Ô∏è Compliance Enforcement Note

If any of the controls described in this document are missing, misconfigured, or bypassed, the solution is considered non-compliant, and an IPT (Incident, Problem, or Task) will be raised for remediation as per operational and security governance processes.

2. Network Isolation & Data Exfiltration Prevention

Control Implemented

Azure Monitor Workspace is deployed with:

publicNetworkAccess: 'Disabled'


All ingestion and query access is via Private Endpoints only.

Risk if Missing

Public exposure of telemetry endpoints

Increased attack surface and potential data leakage

Triggers IPT for security violation

3. Private Link Enforcement for Telemetry

Control Implemented

Private Endpoints for both AMW and AMPLS

AMPLS configured as:

ingestionAccessMode: 'PrivateOnly'
queryAccessMode: 'PrivateOnly'


Risk if Missing

Telemetry traverses public network

Breaks Zero Trust network model

Triggers IPT for non-compliant network design

4. Controlled Resource Scope via AMPLS

Control Implemented

Only explicitly linked resources (DCE) can send or query data.

Risk if Missing

Unauthorized resources may ingest/query telemetry

Loss of data governance

Triggers IPT for access control breach

5. Strong Data Flow Governance

Control Implemented

DCR explicitly defines allowed streams and destinations.

Risk if Missing

Telemetry could be redirected to unauthorized destinations

Violates data handling policies

Triggers IPT for data governance violation

6. No Hardcoded Secrets or Credentials

Control Implemented

No secrets in Bicep

Uses platform-managed identity

Risk if Missing

Credential leakage risk

Compromise of monitoring pipeline

Triggers IPT for security policy violation

7. Least Privilege & Explicit Scoping

Control Implemented

Scoped association of DCR to AKS only

Risk if Missing

Over-privileged resources

Increased blast radius

Triggers IPT for least-privilege violation

8. Auditability & Traceability

Control Implemented

Infrastructure defined as code

All changes version-controlled and auditable

Risk if Missing

No audit trail

Non-compliance with change management policies

Triggers IPT for audit failure

Compliance Summary
Area	Status
Network Isolation	Enforced
Private Access	Enforced
Access Control	Enforced
Data Governance	Enforced
Secrets Management	Enforced
Auditability	Enforced

Any deviation from the above controls will be flagged as non-compliant and an IPT will be raised for investigation and remediation.

‚úÖ Final version includes:

‚úî Explicit IPT enforcement statement
‚úî Risk-based justification per control
‚úî Audit-friendly wording
‚úî Security and governance alignment

If you want this phrased more formally (audit/legal tone) or softer (engineering tone), tell me which style you want and I‚Äôll tweak it üòÑ
