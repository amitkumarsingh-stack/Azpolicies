Thank you for the call.

We’re looking to leverage the built-in policy "Disable Command Invoke on Azure Kubernetes Service Cluster", but we've encountered some challenges with its implementation. Since this is a DeployIfNotExists (DINE) policy, it attempts to deploy the required configuration if it’s not already present. However, this behavior conflicts with other existing policies we have in place.

Specifically, we have several CIS benchmark-aligned policies that deny cluster creation or updates if certain configurations are missing—such as:

Ensuring the AKS cluster is private

Requiring a user-assigned managed identity

Verifying that the OMS agent (Azure Monitor) is enabled

When the built-in policy performs an incremental update, it omits some of these required parameters, which causes the update to be blocked by our existing policies. As a result, the built-in policy fails to apply as intended.

Due to this limitation, we've had to clone and modify the built-in policy to include the necessary parameters, ensuring compatibility with our compliance requirements.
